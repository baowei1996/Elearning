(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin-upload-knowledge"],{"0bac":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",{attrs:{type:"flex"}},[r("upload",{attrs:{isShow:!1,tip:"仅支持上传md格式文件"},on:{upload:e.upload}},[r("el-form-item",{attrs:{slot:"section",label:"所属章节"},slot:"section"},[r("el-tree",{ref:"tree",attrs:{accordion:"",data:e.treeData,"show-checkbox":"",props:e.defaultProps}})],1),r("el-button",{staticStyle:{"font-size":"17px","margin-left":"10px"},attrs:{slot:"add",type:"primary",size:"small"},on:{click:e.showDialog},slot:"add"},[e._v("+")])],1),r("knowledge-table",{attrs:{courses:e.courses,tableData:e.tableData}}),r("add-course-dialog",{attrs:{isVisible:e.isDialogVisible},on:{cancel:e.hideDialog,submit:e.createCourse}})],1)},n=[],a=(r("fb37"),r("c887")),s=(r("0eb5"),r("a4c5"),r("f763"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-table",{ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:"550"}},[r("el-table-column",{attrs:{label:"已上传知识见解",align:"center"}},[r("el-table-column",{attrs:{prop:"course",label:"课程",align:"center",width:"250",filters:e.courses,"filter-method":e.filterHandler}}),r("el-table-column",{attrs:{prop:"chapter",label:"已上传章",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("第"+e._s(t.row.chapter)+"章")])]}}])}),r("el-table-column",{attrs:{prop:"section",label:"已上传节",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sections,function(t){return r("el-tag",{key:t,staticStyle:{margin:"5px 5px"},attrs:{"disable-transitions":""}},[r("span",0==t?[e._v("概述")]:[e._v(e._s(t))])])})}}])})],1)],1)}),i=[],l={props:{tableData:Array,courses:Array},data:function(){return{}},methods:{filterHandler:function(e,t,r){var o=r["property"];return t[o]===e}}},c=l,u=r("6691"),f=Object(u["a"])(c,s,i,!1,null,null,null),d=f.exports,p=r("d443"),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"添加课程",visible:e.isVisible},on:{close:e.cancel}},[r("el-form",{attrs:{model:e.course}},[r("el-form-item",{attrs:{label:"课程名","label-width":e.formLabelWidth}},[r("el-input",{staticStyle:{width:"50%"},attrs:{autocomplete:"off",placeholder:"课程名称"},model:{value:e.course.title,callback:function(t){e.$set(e.course,"title",t)},expression:"course.title"}})],1),r("el-form-item",{attrs:{label:"描述","label-width":e.formLabelWidth}},[r("el-input",{staticStyle:{width:"50%"},attrs:{autocomplete:"off",placeholder:"课程描述"},model:{value:e.course.describe,callback:function(t){e.$set(e.course,"describe",t)},expression:"course.describe"}})],1),r("el-form-item",{attrs:{label:"初始版本号","label-width":e.formLabelWidth}},[r("el-input",{staticStyle:{width:"50%"},attrs:{autocomplete:"off",placeholder:"如 V1.0，V2.1"},model:{value:e.course.vid,callback:function(t){e.$set(e.course,"vid",t)},expression:"course.vid"}})],1),r("el-form-item",{attrs:{label:"封面URL","label-width":e.formLabelWidth}},[r("el-input",{staticStyle:{width:"50%"},attrs:{autocomplete:"off",placeholder:"不填则默认封面"},model:{value:e.course.iconPath,callback:function(t){e.$set(e.course,"iconPath",t)},expression:"course.iconPath"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},b=[],m={props:{isVisible:Boolean},data:function(){return{course:{title:"",describe:"",vid:"",iconPath:""},formLabelWidth:"120px"}},methods:{cancel:function(){this.$emit("cancel")},submit:function(){this.$emit("submit",this.course)}}},g=m,v=Object(u["a"])(g,h,b,!1,null,null,null),y=v.exports,w=r("83af"),S={name:"UploadKnowledge",inject:["reload"],components:{KnowledgeTable:d,Upload:p["a"],AddCourseDialog:y},data:function(){return{tableData:[],courses:[],defaultProps:{children:"children",label:"label"},isDialogVisible:!1}},computed:{treeData:function(){for(var e=[],t=[],r=0;r<15;r++){t=[];for(var o=0;o<15;o++)t.push({label:"第"+(o+1)+"节",value:[r+1,o+1]});e.push({label:"第"+(r+1)+"章",value:r+1,children:t})}return[{label:"全选",children:e}]}},created:function(){this.getTableData()},methods:{upload:function(e){var t=this;if(!t.$refs.tree.getCheckedNodes()[0]||e.course<0||!e.fileList[0].raw)this.$message.warning("请将信息填写完整");else{console.log(JSON.stringify(t.getSeqs(t.$refs.tree.getCheckedNodes())));var r=new FormData;r.append("cid",e.course),r.append("file",e.fileList[0].raw),r.append("seqs",JSON.stringify(t.getSeqs(t.$refs.tree.getCheckedNodes())));var o=!0,n=!1,s=void 0;try{for(var i,l=r.entries()[Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var c=Object(a["a"])(i.value,2),u=c[0],f=c[1];console.log(u,f)}}catch(d){n=!0,s=d}finally{try{o||null==l.return||l.return()}finally{if(n)throw s}}Object(w["c"])().post("/backstage/course/save ",r).then(function(e){console.log(e),200===e.data.code?t.$message({message:"上传成功",type:"success"}):t.$message({message:"请上传格式正确的文件",type:"warning"})}).catch(function(e){console.log(JSON.stringify(e)),t.$message({message:"请上传格式正确的文件",type:"warning"})})}},getSeqs:function(e){var t=[];e.forEach(function(e){e.children||t.push(e.value)});var r=-1,o=t.reduce(function(e,t){if(t[0]===parseInt(Object.keys(e)[r]))e[t[0]].push(t[1]);else{r++;var o=[];o.push(t[1]),e[t[0]]=o}return e},{});for(var n in t=[],o)15==o[n].length?t.push({chapter:parseInt(n),sections:[]}):t.push({chapter:parseInt(n),sections:o[n]});return t},showDialog:function(){this.isDialogVisible=!0},hideDialog:function(){this.isDialogVisible=!1},createCourse:function(e){var t=this;console.log(e),e.iconPath||(e.iconPath="img/logo.jpg"),e.describe&&e.title&&e.vid?this.$http.post("/backstage/course/create",e).then(function(e){console.log(e.data),200===e.data.code?(t.$message({message:"创建课程成功",type:"success"}),t.isDialogVisible=!1,setTimeout(function(){t.reload()},1500)):t.$message({showClose:!0,message:e.data.message,type:"error"})}).catch(function(e){console.log(e)}):this.$message({message:"请将信息填写完整",type:"warning"})},getTableData:function(){var e=this;this.$http.get("/course/getAllCourse").then(function(t){if(200===t.data.code){var r=[];return t.data.data.courses.forEach(function(e){r.push({text:e.courseName,value:e.courseName})}),e.courses=r,t.data.data.courses}e.$message({showClose:!0,message:t.data.message,type:"error"})}).then(function(t){e.getCourseProgress(t)}).catch(function(e){console.log(e)})},getCourseProgress:function(e){var t=this;e.map(function(e){t.$http.post("/backstage/course/progress",{cid:e.cid,vid:e.vid}).then(function(r){200===r.data.code?r.data.data.progress.forEach(function(r){t.tableData.push({course:e.courseName,chapter:r.chapter,sections:r.sections})}):t.$message({showClose:!0,message:r.data.message,type:"error"})}).catch(function(e){console.log(e)})})}}},O=S,L=(r("8c76"),Object(u["a"])(O,o,n,!1,null,null,null));t["default"]=L.exports},"0eb5":function(e,t,r){r("7b01")("asyncIterator")},"0ff6":function(e,t,r){t.f=r("8b37")},"31bc":function(e,t,r){var o=r("cfc7"),n=r("f7c1"),a=r("d217");e.exports=function(e){var t=o(e),r=n.f;if(r){var s,i=r(e),l=a.f,c=0;while(i.length>c)l.call(e,s=i[c++])&&t.push(s)}return t}},"3cc6":function(e,t,r){var o=r("9d01")("meta"),n=r("88dd"),a=r("03b3"),s=r("ddf7").f,i=0,l=Object.isExtensible||function(){return!0},c=!r("b6f1")(function(){return l(Object.preventExtensions({}))}),u=function(e){s(e,o,{value:{i:"O"+ ++i,w:{}}})},f=function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,o)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[o].i},d=function(e,t){if(!a(e,o)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[o].w},p=function(e){return c&&h.NEED&&l(e)&&!a(e,o)&&u(e),e},h=e.exports={KEY:o,NEED:!1,fastKey:f,getWeak:d,onFreeze:p}},"44bd":function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",{attrs:{filterable:"",placeholder:"请选择课程"},on:{change:e.getValue},model:{value:e.courseValue,callback:function(t){e.courseValue=t},expression:"courseValue"}},e._l(e.courses,function(e){return r("el-option",{key:e.cid,attrs:{label:e.courseName,value:e.cid}})}),1)},n=[],a={name:"CourseSelect",data:function(){return{courseValue:-1,courses:[{cid:-1,courseName:"全部"}]}},mounted:function(){this.getCourses()},methods:{getValue:function(){this.$emit("get-course-value",this.courseValue)},getCourses:function(){var e=this;this.$http.get("/course/getAllCourse").then(function(t){200===t.data.code?(e.courses=t.data.data.courses,e.courses.unshift({cid:-1,courseName:"全部"})):e.$message({showClose:!0,message:t.data.message,type:"error"})}).catch(function(e){console.log(e)})}}},s=a,i=r("6691"),l=Object(i["a"])(s,o,n,!1,null,"2f2d36c5",null);t["a"]=l.exports},"4dc8":function(e,t,r){},"52b9":function(e,t,r){},7793:function(e,t,r){var o=r("3a68"),n=r("a891").f,a={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(e){try{return n(e)}catch(t){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?i(e):n(o(e))}},"7b01":function(e,t,r){var o=r("3754"),n=r("a4cc"),a=r("ca2b"),s=r("0ff6"),i=r("ddf7").f;e.exports=function(e){var t=n.Symbol||(n.Symbol=a?{}:o.Symbol||{});"_"==e.charAt(0)||e in t||i(t,e,{value:s.f(e)})}},"813c":function(e,t,r){"use strict";var o=r("52b9"),n=r.n(o);n.a},"8c76":function(e,t,r){"use strict";var o=r("4dc8"),n=r.n(o);n.a},a4c5:function(e,t,r){"use strict";var o=r("3754"),n=r("03b3"),a=r("dad2"),s=r("b2f5"),i=r("e5ef"),l=r("3cc6").KEY,c=r("b6f1"),u=r("adbd"),f=r("6594"),d=r("9d01"),p=r("8b37"),h=r("0ff6"),b=r("7b01"),m=r("31bc"),g=r("b5b8"),v=r("a013"),y=r("88dd"),w=r("db4b"),S=r("3a68"),O=r("5325"),L=r("7dea"),_=r("a7b8"),k=r("7793"),x=r("acb9"),$=r("f7c1"),C=r("ddf7"),D=r("cfc7"),P=x.f,j=C.f,E=k.f,N=o.Symbol,V=o.JSON,T=V&&V.stringify,F="prototype",A=p("_hidden"),M=p("toPrimitive"),I={}.propertyIsEnumerable,J=u("symbol-registry"),W=u("symbols"),G=u("op-symbols"),R=Object[F],U="function"==typeof N&&!!$.f,H=o.QObject,q=!H||!H[F]||!H[F].findChild,z=a&&c(function(){return 7!=_(j({},"a",{get:function(){return j(this,"a",{value:7}).a}})).a})?function(e,t,r){var o=P(R,t);o&&delete R[t],j(e,t,r),o&&e!==R&&j(R,t,o)}:j,K=function(e){var t=W[e]=_(N[F]);return t._k=e,t},B=U&&"symbol"==typeof N.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof N},Y=function(e,t,r){return e===R&&Y(G,t,r),v(e),t=O(t,!0),v(r),n(W,t)?(r.enumerable?(n(e,A)&&e[A][t]&&(e[A][t]=!1),r=_(r,{enumerable:L(0,!1)})):(n(e,A)||j(e,A,L(1,{})),e[A][t]=!0),z(e,t,r)):j(e,t,r)},Q=function(e,t){v(e);var r,o=m(t=S(t)),n=0,a=o.length;while(a>n)Y(e,r=o[n++],t[r]);return e},X=function(e,t){return void 0===t?_(e):Q(_(e),t)},Z=function(e){var t=I.call(this,e=O(e,!0));return!(this===R&&n(W,e)&&!n(G,e))&&(!(t||!n(this,e)||!n(W,e)||n(this,A)&&this[A][e])||t)},ee=function(e,t){if(e=S(e),t=O(t,!0),e!==R||!n(W,t)||n(G,t)){var r=P(e,t);return!r||!n(W,t)||n(e,A)&&e[A][t]||(r.enumerable=!0),r}},te=function(e){var t,r=E(S(e)),o=[],a=0;while(r.length>a)n(W,t=r[a++])||t==A||t==l||o.push(t);return o},re=function(e){var t,r=e===R,o=E(r?G:S(e)),a=[],s=0;while(o.length>s)!n(W,t=o[s++])||r&&!n(R,t)||a.push(W[t]);return a};U||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===R&&t.call(G,r),n(this,A)&&n(this[A],e)&&(this[A][e]=!1),z(this,e,L(1,r))};return a&&q&&z(R,e,{configurable:!0,set:t}),K(e)},i(N[F],"toString",function(){return this._k}),x.f=ee,C.f=Y,r("a891").f=k.f=te,r("d217").f=Z,$.f=re,a&&!r("ca2b")&&i(R,"propertyIsEnumerable",Z,!0),h.f=function(e){return K(p(e))}),s(s.G+s.W+s.F*!U,{Symbol:N});for(var oe="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;oe.length>ne;)p(oe[ne++]);for(var ae=D(p.store),se=0;ae.length>se;)b(ae[se++]);s(s.S+s.F*!U,"Symbol",{for:function(e){return n(J,e+="")?J[e]:J[e]=N(e)},keyFor:function(e){if(!B(e))throw TypeError(e+" is not a symbol!");for(var t in J)if(J[t]===e)return t},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!U,"Object",{create:X,defineProperty:Y,defineProperties:Q,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:re});var ie=c(function(){$.f(1)});s(s.S+s.F*ie,"Object",{getOwnPropertySymbols:function(e){return $.f(w(e))}}),V&&s(s.S+s.F*(!U||c(function(){var e=N();return"[null]"!=T([e])||"{}"!=T({a:e})||"{}"!=T(Object(e))})),"JSON",{stringify:function(e){var t,r,o=[e],n=1;while(arguments.length>n)o.push(arguments[n++]);if(r=t=o[1],(y(t)||void 0!==e)&&!B(e))return g(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!B(t))return t}),o[1]=t,T.apply(V,o)}}),N[F][M]||r("743d")(N[F],M,N[F].valueOf),f(N,"Symbol"),f(Math,"Math",!0),f(o.JSON,"JSON",!0)},a891:function(e,t,r){var o=r("fb6d"),n=r("b4e0").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return o(e,n)}},acb9:function(e,t,r){var o=r("d217"),n=r("7dea"),a=r("3a68"),s=r("5325"),i=r("03b3"),l=r("568a"),c=Object.getOwnPropertyDescriptor;t.f=r("dad2")?c:function(e,t){if(e=a(e),t=s(t,!0),l)try{return c(e,t)}catch(r){}if(i(e,t))return n(!o.f.call(e,t),e[t])}},b5b8:function(e,t,r){var o=r("94ac");e.exports=Array.isArray||function(e){return"Array"==o(e)}},c887:function(e,t,r){"use strict";function o(e){if(Array.isArray(e))return e}function n(e,t){var r=[],o=!0,n=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(o=(s=i.next()).done);o=!0)if(r.push(s.value),t&&r.length===t)break}catch(l){n=!0,a=l}finally{try{o||null==i["return"]||i["return"]()}finally{if(n)throw a}}return r}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(e,t){return o(e)||n(e,t)||a()}r.d(t,"a",function(){return s})},d443:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-col",{staticClass:"resources-file-upload"},[r("el-form",{ref:"form",attrs:{model:e.uploadForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"选择文件"}},[r("el-upload",{ref:"upload",attrs:{action:"file/upload",name:"fileList","file-list":e.uploadForm.fileList,limit:2,"on-exceed":e.handleExceed,"on-change":e.change_file_list,"on-remove":e.handleRemove,"auto-upload":!1,"with-credentials":!0}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),r("div",{staticClass:"resources-file-upload-tips",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.tip))])],1)],1),r("el-form-item",{attrs:{label:"所属课程"}},[r("course-select",{on:{"get-course-value":e.setCourseValue}}),e._t("add")],2),e.isShow?r("el-form-item",{attrs:{label:"所属章节"}},[r("el-cascader",{attrs:{options:e.options,clearable:""},model:{value:e.uploadForm.section,callback:function(t){e.$set(e.uploadForm,"section",t)},expression:"uploadForm.section"}})],1):e._e(),e._t("section"),r("el-form-item",[r("el-button",{attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")])],1),e._t("url")],2)],1)},n=[],a=r("44bd"),s={name:"Upload",props:{tip:String,options:Array,isShow:{type:Boolean,default:!0}},components:{CourseSelect:a["a"]},data:function(){return{courses:[],uploadForm:{fileList:[],course:-1,section:0}}},methods:{handleExceed:function(e,t){this.$message.warning("一次只能上传一个文件")},change_file_list:function(e,t){this.uploadForm.fileList=[e],this.$emit("clearUrl")},setCourseValue:function(e){this.uploadForm.course=e},handlePreview:function(e){console.log(e)},handleRemove:function(e,t){console.log(e,t)},submitUpload:function(){this.$emit("upload",this.uploadForm)}}},i=s,l=(r("813c"),r("6691")),c=Object(l["a"])(i,o,n,!1,null,"3a2bf098",null);t["a"]=c.exports},f763:function(e,t,r){for(var o=r("dac5"),n=r("cfc7"),a=r("e5ef"),s=r("3754"),i=r("743d"),l=r("14fc"),c=r("8b37"),u=c("iterator"),f=c("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=n(p),b=0;b<h.length;b++){var m,g=h[b],v=p[g],y=s[g],w=y&&y.prototype;if(w&&(w[u]||i(w,u,d),w[f]||i(w,f,g),l[g]=d,v))for(m in o)w[m]||a(w,m,o[m],!0)}},f9f2:function(e,t,r){var o=r("b2f5"),n=r("a4cc"),a=r("b6f1");e.exports=function(e,t){var r=(n.Object||{})[e]||Object[e],s={};s[e]=t(r),o(o.S+o.F*a(function(){r(1)}),"Object",s)}},fb37:function(e,t,r){var o=r("db4b"),n=r("cfc7");r("f9f2")("keys",function(){return function(e){return n(o(e))}})}}]);
//# sourceMappingURL=admin-upload-knowledge.5cab6349.js.map